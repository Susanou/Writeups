<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="FCSC 2025" /><meta property="og:locale" content="en_US" /><meta name="description" content="Intro challenges" /><meta property="og:description" content="Intro challenges" /><link rel="canonical" href="http://susanou.github.io/Writeups/posts/FCSC2025/" /><meta property="og:url" content="http://susanou.github.io/Writeups/posts/FCSC2025/" /><meta property="og:site_name" content="Writeups" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-04-20T00:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FCSC 2025" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-04-20T00:00:00+02:00","datePublished":"2025-04-20T00:00:00+02:00","description":"Intro challenges","headline":"FCSC 2025","mainEntityOfPage":{"@type":"WebPage","@id":"http://susanou.github.io/Writeups/posts/FCSC2025/"},"url":"http://susanou.github.io/Writeups/posts/FCSC2025/"}</script><title>FCSC 2025 | Writeups</title><link rel="apple-touch-icon" sizes="180x180" href="/Writeups/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/Writeups/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/Writeups/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/Writeups/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/Writeups/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Writeups"><meta name="application-name" content="Writeups"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/Writeups/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/Writeups/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/Writeups/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/Writeups/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/Writeups/" alt="avatar" class="mx-auto"> <img src="/Writeups/assets/img/sample/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/Writeups/">Writeups</a></div><div class="site-subtitle font-italic">Student by day Hacker by night</div></div><ul class="w-100"><li class="nav-item"> <a href="/Writeups/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/Writeups/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/Writeups/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/Writeups/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/Writeups/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Susanou" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://app.hackthebox.eu/profile/337512" aria-label="htb" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cam.hochberg','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/Writeups/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://www.linkedin.com/in/cam-hochberg/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/Writeups/"> Posts </a> </span> <span>FCSC 2025</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>FCSC 2025</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Cameron Hochberg </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 20, 2025, 12:00 AM +0200" prep="on" > Apr 20 <i class="unloaded">2025-04-20T00:00:00+02:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2096 words">11 min</span></div></div><div class="post-content"><h1 id="intro-challenges">Intro challenges</h1><h2 id="smölkkey">Smölkkey</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">gmpy2</span> <span class="kn">import</span> <span class="n">powmod</span> <span class="k">as</span> <span class="nb">pow</span>
<span class="kn">from</span> <span class="n">Crypto.PublicKey</span> <span class="kn">import</span> <span class="n">RSA</span>

<span class="k">class</span> <span class="nc">Smolkkey</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
		<span class="n">k</span> <span class="o">=</span> <span class="n">RSA</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
		<span class="n">self</span><span class="p">.</span><span class="n">pk</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">.</span><span class="n">e</span><span class="p">)</span>
		<span class="n">self</span><span class="p">.</span><span class="n">sk</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">.</span><span class="n">d</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
		<span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">pk</span>
		<span class="n">c</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
		<span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
		<span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">sk</span>
		<span class="n">m</span> <span class="o">=</span> <span class="nf">pow</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
		<span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

<span class="c1"># Generate a key
</span><span class="n">E</span> <span class="o">=</span> <span class="nc">Smolkkey</span><span class="p">()</span>

<span class="c1"># Encrypt the fag
</span><span class="n">flag</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rb</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>
<span class="n">flag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="sh">"</span><span class="s">little</span><span class="sh">"</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>

<span class="c1"># Test decryption
</span><span class="k">assert</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">E</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

<span class="c1"># Output public values
</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">pk</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">n</span> <span class="o">=</span> <span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">e</span> <span class="o">=</span> <span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">c</span> <span class="o">=</span> <span class="si">}</span><span class="sh">"</span><span class="p">)</span>



<span class="n">n</span> <span class="o">=</span> <span class="mi">20828609401338794038836680655046788059251524928933537772275737490132096798900518851229365799426251400151127719543434160180496659560792762761336988343332946920310984844136554433346165529108260963140451576722579583104830933409454682160084747257400706214980238995436388944310800852033141986598424966358149711167942491331040747300866718813771865768701794983365111208518863175847678947437360554933091347604616653687980177405805542214635577758515398014710929022135522835744517328114492844837858920033569071591971676487452812830920525469634367387593309067794509735740140745616085618489218115494716811261406227449967579233657</span>
<span class="n">e</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">6317668510138686569655374990729607736156413707292408158720036346854309670467296052918552527575331589363290061240725095262980389263184520673983411112154423282089471021996509038472493779143273789325774414352608726252566350689111876373836913240644190951995980896093509379920452743478551321978067299216590452459233562642920123055978471365092000347562228787318105538018723376505390423730687522026043802357456368003656219942603097205774742385485995835519133581552096067468551713114231926639878045212204590071768</span>
</pre></table></code></div></div><p>This challenge is used vanila RSA with some weird values. In this case, we can clearly see that:</p>\[c &lt;&lt; n\]<p>In such cases, it can happen that:</p>\[c^e &lt; n\]<p>and thus we can just take the root <code class="language-plaintext highlighter-rouge">e</code> straight away using regular math.</p><h2 id="solve">Solve</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">gmpy2</span> <span class="kn">import</span> <span class="n">iroot</span>
<span class="n">c</span> <span class="o">=</span> <span class="mi">6317668510138686569655374990729607736156413707292408158720036346854309670467296052918552527575331589363290061240725095262980389263184520673983411112154423282089471021996509038472493779143273789325774414352608726252566350689111876373836913240644190951995980896093509379920452743478551321978067299216590452459233562642920123055978471365092000347562228787318105538018723376505390423730687522026043802357456368003656219942603097205774742385485995835519133581552096067468551713114231926639878045212204590071768</span>
<span class="nf">print</span><span class="p">(</span><span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="nf">iroot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">2</span><span class="p">:])[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># FCSC{30f7c4b2fa7f0fb48bfbd9bbd413491c0a6da660764961b862fe38a83b4bc00f}
</span></pre></table></code></div></div><h2 id="carrote-radis-tomate">Carrote radis tomate</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">pad</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">carotte = </span><span class="sh">"</span><span class="p">,</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">17488856370348678479</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">radis   = </span><span class="sh">"</span><span class="p">,</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16548497022403653709</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tomate  = </span><span class="sh">"</span><span class="p">,</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">17646308379662286151</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">pomme   = </span><span class="sh">"</span><span class="p">,</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">14933475126425703583</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">banane  = </span><span class="sh">"</span><span class="p">,</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">%</span> <span class="mi">17256641469715966189</span><span class="p">)</span>

<span class="n">flag</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rb</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="nf">pad</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">enc = </span><span class="si">{</span><span class="n">enc</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

</pre></table></code></div></div><p>For this challenge, the name is a clear hint to use the Chinese Reminder Theorem (CRT). Using sage math we can find that the key is <code class="language-plaintext highlighter-rouge">58537804506201655097879135670024677446002384165465965481902712238119765745741</code></p><p>The rest is trivial</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="n">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">unpad</span>
<span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="n">long_to_bytes</span>

<span class="n">key</span> <span class="o">=</span> <span class="mi">58537804506201655097879135670024677446002384165465965481902712238119765745741</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="nf">long_to_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_ECB</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="sh">"</span><span class="s">2da1dbe8c3a739d9c4a0dc29a27377fe8abc1c0feacc9475019c5954bbbf74dcedce7ed3dc3ba34fa14a9181d4d7ec0133ca96012b0a9f4aa93c42c61acbeae7640dd101a6d2db9ad4f3b8ccfe285e0d</span><span class="sh">"</span><span class="p">)</span> 
<span class="nf">print</span><span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">enc</span><span class="p">).</span><span class="nf">decode</span><span class="p">())</span>

<span class="c1"># FCSC{2c4c4b3be7d86e1642ce6a8bf1bd75f33b9736e5943f51a49fb9327e248c3b6a}
</span></pre></table></code></div></div><h2 id="meme-generator-not-solved">Meme generator (not solved)</h2><p>For this one, the challenge is to use a bot to recover the file from local storage.</p><p>After some look through the code we can see that there is 2 entries possible:</p><div class="language-php highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'image'</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'text'</span><span class="p">]))</span><span class="o">:</span> <span class="cp">?&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"meme-container"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"img/</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'image'</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="s">"</span> <span class="na">class=</span><span class="s">"img-fluid"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"meme-text"</span><span class="nt">&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">strtoupper</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'text'</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="nt">&lt;/div&gt;</span>
            <span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Using the <code class="language-plaintext highlighter-rouge">image</code> and <code class="language-plaintext highlighter-rouge">text</code> entries gives you the possibility to inject some JS code that can run and recover the flag from <code class="language-plaintext highlighter-rouge">localstorage</code></p><h3 id="red-herring">Red herring</h3><p>While both are possible, I focused mainly on the text one. Realized pretty soon that it had a glaring issue: <code class="language-plaintext highlighter-rouge">echo strtoupper($_GET['text'])</code>. Unfortunately JS is sensitive to case and in this case we would need some way of encoding everything to bypass the <code class="language-plaintext highlighter-rouge">strtoupper</code>. One possibility is <a href="https://jsfuck.com">JS Fuck</a> but unfortunately the payload we need would be too big for the bot and just fail.</p><h3 id="actual-solution">Actual solution</h3><p>Instead of using the <code class="language-plaintext highlighter-rouge">text</code> field you can use the <code class="language-plaintext highlighter-rouge">image</code> field and force JS code to execute since there is no formatting for that part of the code.</p><p>We know that we have access to all the <code class="language-plaintext highlighter-rouge">console.log</code> from the code of the bot so our goal is to execute the following payload: <code class="language-plaintext highlighter-rouge">console.log(localStorage.getItem('flag'))</code></p><p>Since there is no formatting we can just add the payload right after the image source and just add <code class="language-plaintext highlighter-rouge">"</code>to get out of the <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tag giving us:</p><p><code class="language-plaintext highlighter-rouge">http://meme-generator/?image=grumpy.jpeg"&gt;&lt;script&gt;console.log(localStorage.getItem('flag'))&lt;/script&gt;&amp;text=oops</code></p><p>This will get you the flag</p><h2 id="touillette">Touillette</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">flag</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">()</span>
<span class="k">assert</span> <span class="nf">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">==</span> <span class="mi">64</span>

<span class="n">x</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
<span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
</pre></table></code></div></div><h3 id="my-solve">My solve</h3><p>Here is actually tried to understand what was done and reverse it part by part. Pretty long to do</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="n">flag</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">Z2yFm7bCjR6SMWOCSiw{wqKWoJxTtxP4Hf74mQZ4qmghcu1mdX9HND7u8oxF}JsR</span><span class="sh">"""</span>

<span class="n">x</span> <span class="o">=</span> <span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">([</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">8</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">7</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
    <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">::</span><span class="o">-</span><span class="mi">8</span><span class="p">],</span>
<span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>

<span class="n">flag1</span> <span class="o">=</span> <span class="n">flag</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="n">flag</span><span class="p">[</span><span class="mi">32</span><span class="p">:]</span>

<span class="n">trueFlag</span> <span class="o">=</span> <span class="sh">""</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">flag1</span><span class="p">,</span> <span class="n">flag2</span><span class="p">):</span>
    <span class="n">trueFlag</span> <span class="o">+=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">x</span>

<span class="nf">print</span><span class="p">(</span><span class="n">trueFlag</span><span class="p">)</span>

<span class="n">partition</span> <span class="o">=</span> <span class="mi">64</span><span class="o">/</span><span class="mi">8</span>

<span class="n">flag1</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">partition</span><span class="p">]</span>
<span class="n">flag2</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="p">:</span><span class="n">partition</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>
<span class="n">flag3</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="o">*</span><span class="mi">2</span><span class="p">:</span><span class="n">partition</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span>
<span class="n">flag4</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="o">*</span><span class="mi">3</span><span class="p">:</span><span class="n">partition</span><span class="o">*</span><span class="mi">4</span><span class="p">]</span>
<span class="n">flag5</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="o">*</span><span class="mi">4</span><span class="p">:</span><span class="n">partition</span><span class="o">*</span><span class="mi">5</span><span class="p">]</span>
<span class="n">flag6</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="o">*</span><span class="mi">5</span><span class="p">:</span><span class="n">partition</span><span class="o">*</span><span class="mi">6</span><span class="p">]</span>
<span class="n">flag7</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="o">*</span><span class="mi">6</span><span class="p">:</span><span class="n">partition</span><span class="o">*</span><span class="mi">7</span><span class="p">]</span>
<span class="n">flag8</span> <span class="o">=</span> <span class="n">trueFlag</span><span class="p">[</span><span class="n">partition</span><span class="o">*</span><span class="mi">7</span><span class="p">:</span><span class="mi">64</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="n">flag1</span><span class="p">)</span>

<span class="n">ret</span> <span class="o">=</span> <span class="sh">""</span>

<span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">flag1</span><span class="p">,</span><span class="n">flag2</span><span class="p">,</span> <span class="n">flag3</span><span class="p">,</span> <span class="n">flag4</span><span class="p">,</span> <span class="n">flag5</span><span class="p">,</span> <span class="n">flag6</span><span class="p">,</span> <span class="n">flag7</span><span class="p">,</span> <span class="n">flag8</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">h</span> <span class="o">+</span> <span class="n">g</span> <span class="o">+</span><span class="n">f</span>  <span class="o">+</span><span class="n">e</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span><span class="n">c</span>  <span class="o">+</span><span class="n">b</span> <span class="o">+</span><span class="n">a</span>

<span class="nf">print</span><span class="p">(</span><span class="n">ret</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

</pre></table></code></div></div><h3 id="better-solve">Better solve</h3><p>A friend after the end made me realize that this is technically a basic substitution cipher so you can just go and find the index from the original alphabet and tada you get the reversed flag</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">etalon</span> <span class="o">=</span> <span class="sh">"</span><span class="s">0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUWXYZ-_=</span><span class="sh">"</span>
<span class="n">touilled_etalon</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Mwg0Nxh1Oyi2Pzj3QAk4RBl5SCm6TDn7UEo8WFp9XGqaYHrbZIsc-Jtd_Kue=Lvf</span><span class="sh">"</span>
<span class="n">touilled_flag</span><span class="o">=</span><span class="sh">"</span><span class="s">Z2yFm7bCjR6SMWOCSiw{wqKWoJxTtxP4Hf74mQZ4qmghcu1mdX9HND7u8oxF}JsR</span><span class="sh">"</span>
<span class="n">flag</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">/</span><span class="sh">"</span><span class="p">]</span><span class="o">*</span><span class="mi">64</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
    <span class="n">curr_char</span> <span class="o">=</span> <span class="n">touilled_etalon</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">i_prime</span> <span class="o">=</span> <span class="n">etalon</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">curr_char</span><span class="p">)</span>
    <span class="n">flag</span><span class="p">[</span><span class="n">i_prime</span><span class="p">]</span> <span class="o">=</span> <span class="n">touilled_flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">flag</span><span class="p">))</span>

<span class="c1">#FCSC{WT444hmHuFRyb6OwKxP7Zg197xs27RWiqJxfQmuXDoJZmjMSwotHmqcdN8}
</span></pre></table></code></div></div><h1 id="crypto-challenges">Crypto challenges</h1><h2 id="la-qu6ete-de-lanneau">La qu6ete de l’anneau</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">from</span> <span class="n">Crypto.Util.number</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="n">Crypto.Random.random</span> <span class="kn">import</span> <span class="n">randrange</span>
<span class="kn">from</span> <span class="n">math</span> <span class="kn">import</span> <span class="n">gcd</span>

<span class="k">class</span> <span class="nc">Cipher</span><span class="p">:</span>

	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">512</span><span class="p">):</span>
		<span class="n">self</span><span class="p">.</span><span class="n">s</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">size</span> <span class="o">+</span> <span class="nf">randrange</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">size</span><span class="p">)</span>
		<span class="n">self</span><span class="p">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">size</span> <span class="o">//</span> <span class="mi">8</span>

	<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
		<span class="k">assert</span> <span class="nf">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">bs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Error: wrong length (</span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span>
		<span class="n">C</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">self</span><span class="p">.</span><span class="n">bs</span><span class="p">):</span>
			<span class="n">iv</span> <span class="o">=</span> <span class="nf">randrange</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span>
			<span class="k">while</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
				<span class="n">iv</span> <span class="o">=</span> <span class="nf">randrange</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span>
			<span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">bs</span><span class="p">],</span><span class="sh">"</span><span class="s">big</span><span class="sh">"</span><span class="p">)</span>
			<span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
				<span class="n">C</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
					<span class="sh">"</span><span class="s">iv</span><span class="sh">"</span> <span class="p">:</span> <span class="n">iv</span><span class="p">,</span>
					<span class="sh">"</span><span class="s">c</span><span class="sh">"</span> <span class="p">:</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">iv</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">,</span>
				<span class="p">})</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">C</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
					<span class="sh">"</span><span class="s">m</span><span class="sh">"</span> <span class="p">:</span> <span class="n">b</span><span class="p">,</span>
					<span class="sh">"</span><span class="s">iv</span><span class="sh">"</span> <span class="p">:</span> <span class="n">iv</span><span class="p">,</span>
					<span class="sh">"</span><span class="s">c</span><span class="sh">"</span> <span class="p">:</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">iv</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">,</span>
				<span class="p">})</span>

		<span class="k">return</span> <span class="n">C</span>

	<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
		<span class="n">r</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">""</span>
		<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">c</span><span class="p">:</span>
			<span class="n">m</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">c</span><span class="sh">"</span><span class="p">]</span> <span class="o">*</span> <span class="nf">pow</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">iv</span><span class="sh">"</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">s</span>
			<span class="n">r</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">bs</span><span class="p">,</span><span class="sh">"</span><span class="s">big</span><span class="sh">"</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">r</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>

	<span class="n">flag</span> <span class="o">=</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rb</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>
	<span class="k">assert</span> <span class="nf">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">==</span> <span class="mi">64</span><span class="p">,</span> <span class="sh">"</span><span class="s">Error: wrong flag length.</span><span class="sh">"</span>

	<span class="n">E</span> <span class="o">=</span> <span class="nc">Cipher</span><span class="p">()</span>

	<span class="n">m</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">64</span><span class="p">).</span><span class="nf">hex</span><span class="p">()</span>
	<span class="n">data</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="nf">encode</span><span class="p">(),</span> <span class="n">data</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

	<span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
	<span class="k">assert</span> <span class="n">flag</span> <span class="o">==</span> <span class="n">E</span><span class="p">.</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">),</span> <span class="sh">"</span><span class="s">Error: decryption test failed.</span><span class="sh">"</span>

	<span class="nf">print</span><span class="p">(</span><span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span>
		<span class="sh">"</span><span class="s">data</span><span class="sh">"</span> <span class="p">:</span> <span class="n">data</span><span class="p">,</span>
		<span class="sh">"</span><span class="s">C</span><span class="sh">"</span> <span class="p">:</span> <span class="n">C</span>
	<span class="p">},</span> <span class="n">indent</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>{
    "data": [
        {
            "m": 5300924613498218875069386136478898074006475860605696653663766789647491408111939951962787562515179231001576088241821257224379937942480792836286291708950580,
            "iv": 990478785346720639288503860820230515465392521155988529067551628642203679040736067705099478569806691727869997283427937397835972477847915536798446362176571,
            "c": 14608971898840483258729047186216694135901081092160417249500736213435666342621773315139756301160520793786438865525865528889455866097651720255856961635805732
        },
        {
            "m": 5100397453901829001001274202132069470845583300596122363556250272408483548979629877688935275217404969058564324787967275472360630765503385955263068863095345,
            "iv": 7475569552781515571825018823124971469978831837925573660203231293669196922174669333904855142066157502493624218193454674776997566021222129832543051527639435,
            "c": 7362760529141371598441777437669466021221530082696679574829167632394833775523119009628310509508552230962414538323390642388879749988667246066507482829109785
        }
    ],
    "C": [
        {
            "iv": 14065646473510331612652599339352010982436820046928032638519239485603018733626860766641543018671779202005925711911356379944986562755350855828351678555098061,
            "c": 8973029504100997651890859382562887986006499283456026995696294203177046779401655025542878703573157181581548171480134446908730999381542131074327319465448895
        }
    ]
}
</pre></table></code></div></div><p>For this challenge, the key resides in the fact that in cases where the message is too long we get more info:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="n">self</span><span class="p">.</span><span class="n">bs</span><span class="p">):</span>
    <span class="n">iv</span> <span class="o">=</span> <span class="nf">randrange</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span>
    <span class="k">while</span> <span class="nf">gcd</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span><span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="nf">randrange</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">bs</span><span class="p">],</span><span class="sh">"</span><span class="s">big</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">C</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
            <span class="sh">"</span><span class="s">iv</span><span class="sh">"</span> <span class="p">:</span> <span class="n">iv</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">c</span><span class="sh">"</span> <span class="p">:</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">iv</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">C</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
            <span class="sh">"</span><span class="s">m</span><span class="sh">"</span> <span class="p">:</span> <span class="n">b</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">iv</span><span class="sh">"</span> <span class="p">:</span> <span class="n">iv</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">c</span><span class="sh">"</span> <span class="p">:</span> <span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">iv</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">s</span><span class="p">,</span>
        <span class="p">})</span>
</pre></table></code></div></div><p>Thankfully for us, while the original message is short and only gives us one point of data, the rest is long and gives us 2 points. Thus we now have a way to solve this for the modulus:</p><p>We thus have:</p>\[b_1 * iv_1 \cong c_1\ [n] \newline \Leftrightarrow b_1 * iv_1 - c_1 \cong 0\ [n] \newline \Leftrightarrow b_1 * iv_1 - c_1 = n * k_1\]<p>For some random <code class="language-plaintext highlighter-rouge">k</code>. We have that for 2 points and we can assume that k will be significantly smaller than <code class="language-plaintext highlighter-rouge">n</code>. Thus finding the GCD will give us <code class="language-plaintext highlighter-rouge">n</code>. We can then use that to find what the original message <code class="language-plaintext highlighter-rouge">m</code> is by:</p>\[b * iv \cong c\ [n] \Leftrightarrow b \cong c * iv^{-1} [n]\]<h2 id="cocorico">Cocorico</h2><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">zlib</span> <span class="kn">import</span> <span class="n">crc32</span> <span class="k">as</span> <span class="n">le_mac</span>
<span class="kn">from</span> <span class="n">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>

<span class="k">class</span> <span class="nc">CocoRiCo_Chiffrement_AEAD</span><span class="p">:</span>
	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">la_clef</span><span class="p">):</span>
		<span class="n">self</span><span class="p">.</span><span class="n">la_clef</span> <span class="o">=</span> <span class="n">la_clef</span>

	<span class="k">def</span> <span class="nf">le_chiffrement</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">la_clef</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_OFB</span><span class="p">,</span> <span class="n">iv</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x00</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>
 
	<span class="k">def</span> <span class="nf">chiffrer_integre</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">le_message</span><span class="p">):</span>
		<span class="n">le_tag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">le_mac</span><span class="p">(</span><span class="n">le_message</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">le_chiffrement</span><span class="p">().</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">le_message</span> <span class="o">+</span> <span class="n">le_tag</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">dechiffrer</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">le_chiffre</span><span class="p">):</span>
		<span class="n">x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">le_chiffrement</span><span class="p">().</span><span class="nf">decrypt</span><span class="p">(</span><span class="n">le_chiffre</span><span class="p">)</span>
		<span class="n">le_message</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
		<span class="n">le_tag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">le_mac</span><span class="p">(</span><span class="n">le_message</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">le_tag</span> <span class="o">==</span> <span class="n">t</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">le_message</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="sa">b</span><span class="sh">""</span>

<span class="k">try</span><span class="p">:</span>
	<span class="n">la_clef</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="nf">urandom</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span>
	<span class="n">E</span> <span class="o">=</span> <span class="nc">CocoRiCo_Chiffrement_AEAD</span><span class="p">(</span><span class="n">la_clef</span><span class="p">)</span>

	<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="sh">"</span><span class="s">FCSC</span><span class="sh">"</span><span class="p">:</span>

		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">0. Quit</span><span class="sh">"</span><span class="p">)</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">1. Login</span><span class="sh">"</span><span class="p">)</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">2. Logout</span><span class="sh">"</span><span class="p">)</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">3. TODO</span><span class="sh">"</span><span class="p">)</span>
		<span class="n">choice</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">&gt;&gt;&gt; </span><span class="sh">"</span><span class="p">))</span>

		<span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
			<span class="k">break</span>

		<span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

			<span class="n">new</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Are you new ? (y/n) </span><span class="sh">"</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">:</span>

				<span class="n">name</span> <span class="o">=</span> <span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Name: </span><span class="sh">"</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="sh">"</span><span class="s">toto</span><span class="sh">"</span><span class="p">:</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Toto is one of our admin! Do not try to outsmart the system!</span><span class="sh">"</span><span class="p">)</span>
					<span class="nf">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

				<span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span>
					<span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
					<span class="sh">"</span><span class="s">admin</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
				<span class="p">}).</span><span class="nf">encode</span><span class="p">()</span>

				<span class="n">c</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="nf">chiffrer_integre</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Welcome </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s">. Here is your token:</span><span class="sh">"</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="n">c</span><span class="p">.</span><span class="nf">hex</span><span class="p">())</span>

				<span class="n">logged</span> <span class="o">=</span> <span class="mi">1</span>

				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">This challenge is still under active developement, please come back in a few weeks to try it out!</span><span class="sh">"</span><span class="p">)</span>
				<span class="c1"># TODO: Add vulnerable code here
</span>
			<span class="k">elif</span> <span class="n">new</span> <span class="o">==</span> <span class="sh">"</span><span class="s">n</span><span class="sh">"</span><span class="p">:</span>

				<span class="n">token</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">(</span><span class="nf">input</span><span class="p">(</span><span class="sh">"</span><span class="s">Token: </span><span class="sh">"</span><span class="p">))</span>
				<span class="n">x</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="nf">dechiffrer</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
				<span class="n">d</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">toto</span><span class="sh">"</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="sh">"</span><span class="s">admin</span><span class="sh">"</span><span class="p">]:</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Congrats! Here is your flag:</span><span class="sh">"</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">flag.txt</span><span class="sh">"</span><span class="p">).</span><span class="nf">read</span><span class="p">().</span><span class="nf">strip</span><span class="p">())</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Weclome back </span><span class="si">{</span><span class="n">d</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">!</span><span class="sh">"</span><span class="p">)</span>

		<span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
			<span class="n">logged</span> <span class="o">=</span> <span class="mi">0</span>

		<span class="k">elif</span> <span class="n">choice</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">This challenge is still under active developement, please come back in a few weeks to try it out!</span><span class="sh">"</span><span class="p">)</span>
			<span class="c1"># TODO: Add another vuln here
</span>
<span class="k">except</span><span class="p">:</span>
	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Please check your inputs.</span><span class="sh">"</span><span class="p">)</span>

</pre></table></code></div></div><p>This challenge asks us to forge a token. Thankfully we can create our own. The 2 function that interest us are the following:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">le_chiffrement</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">AES</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">la_clef</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_OFB</span><span class="p">,</span> <span class="n">iv</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="se">\x00</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">16</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">chiffrer_integre</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">le_message</span><span class="p">):</span>
    <span class="n">le_tag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">le_mac</span><span class="p">(</span><span class="n">le_message</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">le_chiffrement</span><span class="p">().</span><span class="nf">encrypt</span><span class="p">(</span><span class="n">le_message</span> <span class="o">+</span> <span class="n">le_tag</span><span class="p">)</span>
</pre></table></code></div></div><p>We can see that the iv is constant and the key as well. AES OFB only XORs the plain text with the iv after the later went through a round of AES. We just need to get that output in order to forge our message. The tag is trivial to find as it is just the CRC32 checksum of the message.</p><p>My solve is as follows:</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span>
<span class="c1"># Install using pip:
#    pip install pwntools --break-system-packages
</span><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">zlib</span> <span class="kn">import</span> <span class="n">crc32</span>

<span class="sh">'''</span><span class="s">
To use this template, execute the script with python3:
$ python3 template.py

If you want to run it with a different server and port, use
$ python3 template.py HOST=localhost PORT=4000

If you want to debug and see the data going exchanged, add </span><span class="sh">"</span><span class="s">DEBUG</span><span class="sh">"</span><span class="s">:
$ python3 template.py DEBUG
</span><span class="sh">'''</span>

<span class="c1"># Define the remote connexion details: server address and port
</span><span class="n">HOST</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">HOST</span> <span class="ow">or</span> <span class="sh">"</span><span class="s">chall.fcsc.fr</span><span class="sh">"</span>
<span class="n">PORT</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="n">PORT</span> <span class="ow">or</span> <span class="mi">2150</span>

<span class="c1"># Connect to the remote server
# The variable "io" will be used to send and receive text to the remove server
</span><span class="n">io</span> <span class="o">=</span> <span class="nf">remote</span><span class="p">(</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">&gt;&gt;&gt;</span><span class="sh">"</span><span class="p">)</span>


<span class="n">admin</span> <span class="o">=</span> <span class="sh">"</span><span class="s">toto</span><span class="sh">"</span>
<span class="n">adminMsg</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">toto</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">admin</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,}).</span><span class="nf">encode</span><span class="p">()</span>
<span class="n">adminTag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">crc32</span><span class="p">(</span><span class="n">adminMsg</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="sh">"</span><span class="s">big</span><span class="sh">"</span><span class="p">)</span>
<span class="n">user</span> <span class="o">=</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span>
<span class="n">userMessage</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span><span class="sh">"</span><span class="s">admin</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,}).</span><span class="nf">encode</span><span class="p">()</span>
<span class="n">tag</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="nf">crc32</span><span class="p">(</span><span class="n">userMessage</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="sh">"</span><span class="s">big</span><span class="sh">"</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">.</span><span class="nf">encode</span><span class="p">())</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">Are you new ? (y/n) </span><span class="sh">"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sh">"</span><span class="s">y</span><span class="sh">"</span><span class="p">.</span><span class="nf">encode</span><span class="p">())</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">Name: </span><span class="sh">"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">userMessage</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">()</span>


<span class="n">token</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">.</span><span class="nf">fromhex</span><span class="p">((</span><span class="n">io</span><span class="p">.</span><span class="nf">recvline</span><span class="p">().</span><span class="nf">decode</span><span class="p">()))</span>
<span class="n">iv</span> <span class="o">=</span> <span class="nf">xor</span><span class="p">(</span><span class="n">userMessage</span><span class="o">+</span><span class="n">tag</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">token</span><span class="p">.</span><span class="nf">hex</span><span class="p">())</span>
<span class="nf">print</span><span class="p">(</span><span class="n">iv</span><span class="p">.</span><span class="nf">hex</span><span class="p">())</span>

<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">&gt;&gt;&gt; </span><span class="sh">"</span><span class="p">)</span>

<span class="n">forged</span> <span class="o">=</span> <span class="nf">xor</span><span class="p">(</span><span class="n">adminMsg</span><span class="o">+</span><span class="n">adminTag</span><span class="p">,</span> <span class="n">iv</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">.</span><span class="nf">encode</span><span class="p">())</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">Are you new ? (y/n) </span><span class="sh">"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="sh">"</span><span class="s">n</span><span class="sh">"</span><span class="p">.</span><span class="nf">encode</span><span class="p">())</span>
<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">Token: </span><span class="sh">"</span><span class="p">)</span>

<span class="n">io</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">forged</span><span class="p">.</span><span class="nf">hex</span><span class="p">().</span><span class="nf">encode</span><span class="p">())</span>


<span class="n">io</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">&gt;&gt;&gt; </span><span class="sh">"</span><span class="p">)</span>
<span class="n">io</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/Writeups/categories/fcsc-2025/'>FCSC 2025</a>, <a href='/Writeups/categories/crypto/'>Crypto</a>, <a href='/Writeups/categories/intro/'>Intro</a>, <a href='/Writeups/categories/web/'>Web</a>, <a href='/Writeups/categories/rev/'>rev</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/Writeups/tags/crt/" class="post-tag no-text-decoration" >CRT</a> <a href="/Writeups/tags/js/" class="post-tag no-text-decoration" >JS</a> <a href="/Writeups/tags/intro/" class="post-tag no-text-decoration" >Intro</a> <a href="/Writeups/tags/reverse/" class="post-tag no-text-decoration" >Reverse</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=FCSC 2025 - Writeups&url=http://susanou.github.io/Writeups/posts/FCSC2025/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=FCSC 2025 - Writeups&u=http://susanou.github.io/Writeups/posts/FCSC2025/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=FCSC 2025 - Writeups&url=http://susanou.github.io/Writeups/posts/FCSC2025/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/Writeups/posts/cycling/">Cycling</a><li><a href="/Writeups/posts/mlsteal/">MLSteal</a><li><a href="/Writeups/posts/pythia/">Pythia</a><li><a href="/Writeups/posts/ChunkNoris/">Chunk Norris</a><li><a href="/Writeups/posts/Admirer/">Admirer</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/Writeups/tags/crypto/">crypto</a> <a class="post-tag" href="/Writeups/tags/rsa/">RSA</a> <a class="post-tag" href="/Writeups/tags/easy/">easy</a> <a class="post-tag" href="/Writeups/tags/web/">web</a> <a class="post-tag" href="/Writeups/tags/aes/">AES</a> <a class="post-tag" href="/Writeups/tags/linux/">linux</a> <a class="post-tag" href="/Writeups/tags/misc/">misc</a> <a class="post-tag" href="/Writeups/tags/mitm/">MITM</a> <a class="post-tag" href="/Writeups/tags/sqli/">SQLi</a> <a class="post-tag" href="/Writeups/tags/crt/">CRT</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/Writeups/posts/composition/"><div class="card-body"> <span class="timeago small" > Apr 7, 2021 <i class="unloaded">2021-04-07T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Composition</h3><div class="text-muted small"><p></p></div></div></a></div><div class="card"> <a href="/Writeups/posts/emdeefiveforlife/"><div class="card-body"> <span class="timeago small" > Jul 20, 2020 <i class="unloaded">2020-07-20T15:50:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Emdee Five for Life</h3><div class="text-muted small"><p> Emdee Five For Life The idea of this challenge is to get the string and encrypt it using MD5 as fast as possible. Just write a small python script and get the flag from the result import request...</p></div></div></a></div><div class="card"> <a href="/Writeups/posts/freelancer/"><div class="card-body"> <span class="timeago small" > Jul 21, 2020 <i class="unloaded">2020-07-21T15:50:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Freelancer</h3><div class="text-muted small"><p> Freelancer First if you look at the source code, you will find interesting comments: &lt;img class="img-fluid" src="img/portfolio/cake.png" alt="" /&gt; &lt;!-- &lt;a href="portfolio.php?id=2"&gt...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/Writeups/posts/mlsteal/" class="btn btn-outline-primary" prompt="Older"><p>MLSteal</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/Writeups/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//writeups-fukurou.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'FCSC 2025'; this.page.url = 'http://susanou.github.io/Writeups/posts/FCSC2025/'; this.page.identifier = '/posts/FCSC2025/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/Susanou">Cameron Hochberg</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div><script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="Susanou" data-description="Support me on Buy me a coffee!" data-message="" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/Writeups/tags/crypto/">crypto</a> <a class="post-tag" href="/Writeups/tags/rsa/">RSA</a> <a class="post-tag" href="/Writeups/tags/easy/">easy</a> <a class="post-tag" href="/Writeups/tags/web/">web</a> <a class="post-tag" href="/Writeups/tags/aes/">AES</a> <a class="post-tag" href="/Writeups/tags/linux/">linux</a> <a class="post-tag" href="/Writeups/tags/misc/">misc</a> <a class="post-tag" href="/Writeups/tags/mitm/">MITM</a> <a class="post-tag" href="/Writeups/tags/sqli/">SQLi</a> <a class="post-tag" href="/Writeups/tags/crt/">CRT</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/Writeups/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://susanou.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
